```
æ ‡é¢˜: è®°ä¸€æ¬¡ Python Code Injection å®æˆ˜
åˆ›å»º: 2021-01-05
æ›´æ–°: 2024-02-03
```

> ä» CN-SEC æ‰¾å›çš„æ—§æ–‡


---


æµ‹è¯•ç¯å¢ƒå·²è·å¾—æˆæƒ


### å‡‘å­—æ•¸

å‰›éå®Œå¹´å°±æ¬ç –æ¬åˆ°åŒ—äº¬ä¾†äº†ï¼ï¼ï¼

ç®€å•åœ°è¨˜éŒ„ä¸€ä¸‹é€™å¹¾å¤©çš„å·¥ä½œäº§å‡º(BurpSuite æ°¸é çš„ç¥ï¼ï¼ï¼)

![](./img/1706967625859.png)

é€™ç¯‡æ–‡ç« ä¸»è¦æ˜¯å°python code injection çš„å¾©ç¾å­¸ç¿’ã€‚

### æ­£æ–‡

å¼€å±€ä¸€å¼ å›¾

![](./img/1706967641779.png)

burpå†…ç½®çš„payload:
```
eval(compile('
for x in range(1):\n 
import time\n 
time.sleep(20)','a','single'))
```
ä½œç”¨ï¼šé€šéå“åº”åŒ…çš„è¿”å›æ™‚é–“æ˜¯å¦å»¶é²ä¾†åˆ¤æ–·æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

æ³¨ï¼šè©²payloadåœ¨é‡ä¸Š timeout æ™‚æœƒæœ‰èª¤å ±ï¼Œæ¯”å¦‚ä»Šå¤©ç™½é«˜èˆˆä¸€æ—©ä¸Šçš„æˆ‘ğŸ™ˆã€‚

æ‰€ä»¥å…ˆéªŒè¯è©²æ¼æ´æ˜¯å¦ç‚ºèª¤å ±ï¼š

payload1:

![](./img/1706967727049.png)


![](./img/1706967742977.png)

å¯ä»¥çœ‹è¦‹ç›¸å·®10å€å·¦å³çš„å»¶é²ï¼Œå®é”¤ï¼å®é”¤ï¼å®é”¤ï¼

æ¥ä¸‹ä¾†çš„æ“ä½œè‡ªç„¶æ˜¯ä»¥æ‹¿åˆ°æƒé™çˆ²ä¸»ã€‚

#### ä¸´æ—¶æŠ±ä½›è„š

å…¶å®é€™å°±æ˜¯å®ä¹ (ç»éªŒ)å¸¶ä¾†çš„å¥½è™•ï¼Œå½“ç„¶è¿™æ˜¯å°æ–¼æˆ‘è€Œè¨€ã€‚ä¸€èˆ¬åœ¨é …ç›®ä¸­é‡åˆ°å„ç¨®æƒ…æ³ï¼Œç„¶å¾Œ å­¦ä¹ æ–°çŸ¥è¯† -> è§£å†³é—®é¢˜ -> æ€»ç»“ç»éªŒã€‚

![](./img/1706967779384.png)

é€šéæœ¬åœ°å„ç§å°è¯•ä¹‹å¾Œï¼Œçµ‚æ–¼ææ¸…æ¥šäº†payloadçš„æ„é€ åŸç†ï¼Œç¾åœ¨ä¾¿å¯ä»¥æ ¹æ®å¿ƒæƒ…è‡ªç”±ç™¼æ®äº†ã€‚

æœ¬åœ°æ¸¬è©¦ï¼š

![](./img/1706967806496.png)

æ¼æ´ç’°å¢ƒï¼š

![](./img/1706967825496.png)

æœ¬åœ°æ¸¬è©¦ï¼š

![](./img/1706967837252.png)

æ¼æ´ç’°å¢ƒï¼š

![](./img/1706967849327.png)

#### åå½ˆshell

å¦‚åœ–ï¼š
![](./img/1706967882999.png)

---

åƒè€ƒï¼š

https://github.com/sethsec/PyCodeInjection
https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html


